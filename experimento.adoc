:imagesdir: _images
:table-caption: Tabla

// Configuración github
ifdef::env-github[]
:tip-caption: :bulb:
:note-caption: :information_source:
:important-caption: :heavy_exclamation_mark:
:caution-caption: :fire:
:warning-caption: :warning:
endif::[]

ifndef::toc[]
:numbered:
:toc:
:toclevels: 5
:lang: es
:encoding: utf8
:sectnumlevels: 5
:toc-title: Índice
:toc-placement: manual
:stem: latexmath

toc::[]

== Experimento

endif::[]

Moodle es una herramienta en constante y activo desarrollo.
Es por ello que su la definición de su modelo de datos, reflejada en la base de datos, puede ser igualmente cambiante.

Pero, al mismo tiempo, es una herramienta con la suficiente madurez como para poder afirmar que existe cierta estabilidad en dicho modelo de datos.

Como muestra de ambas cosas (tanto de la actividad del proyecto como de su madurez) puede verse la comparativa de la  <<tabla_indicadores_git_moodle>> y de las figuras <<figura_num_autores_git_moodle>> y <<figura_num_commits_git_moodle>>.
En ellas comparamos algunos indicadores generales sobre el repositorio de código fuente del proyecto _moodle_ con los de otro proyecto de código abierto de mayor alcance: _git_.

.Indicadores de los repositorios de código de _git_ y _moodle_
[[tabla_indicadores_git_moodle]]
[%header,cols="40%h,30%,30%"]
|===
||moodle|git
|Nº de commits totales|89.566|51805
|Duración (primer commit)|17 años

(2001-11-22)|13 años

(2005-04-07)
|Nº de autores|787|1598
|===

.Núm. de autores por año de proyectos moodle y git
[[figura_num_autores_git_moodle]]
image::num_autores_per_year.png[]

.Núm. de commits por año de proyectos moodle y git
[[figura_num_commits_git_moodle]]
image::num_commits_per_year.png[]

Es por esto por lo que, si bien se indicará, en lo posible, las versiones del código que se usarán en este análisis preliminiar, se puede suponer que no habrá diferencias sustanciales entre ellas en lo que al modelo de datos se refiere.


=== Análisis de BD de Moodle

Como primera aproximación al problema se realiza un análisis superficial (número y estructura de tablas y vistas) a partir de una base de datos de una instalación _limpia_ de Moodle (sin contenido ni módulos adicionales).

Lo que se quiere dilucidar a partir de este análisis será lo siguiente:

* Número de tablas.
* Número de vistas
* Estructura general de las mismas.

Para este análisis se ha empleado una instalación de Moodle que se corresponde con la versión:

 Moodle 3.5+ (Build: 20180614)

A partir de ella se obtienen los siguientes resultado numéricos:

* Número de tablas: *401*.
* Número de vistas: 0

El número de tablas es lo suficientemente grande como para entrar en el detalle de cada una de ellas en este documento.
Sin embargo, los nombres de las tablas dan una idea de la agrupación conceptual interna entre las distintas tablas.
Estos nombres tienen este formato:

 mdl_{grupo}[_{elemento}]

Siendo _{grupo}_ el grupo conceptual que se menciona más arriba. Opcionalmente puede seguir una diferenciación más específica con _{elemento}_.

Con esta clasificación se obtendrían 86 grupos conceptuales de los que se muestran algunos ejemplos a continuación:

* _badge_
* _blog_
* _competency_
* _course_
* _events_
* _forum_
* _grading_
* _lesson_
* _question_
* _quiz_
* _rating_
* _workshop_

Para extraer algo más de información del esquema de la base de datos se emplea la herramienta *MySQL Workbench* para realizar ingeniería inversa y extraer a partir de una base de datos su diagrama de Entidad-Relación (diagrama ER).

.Diagrama E-R de la BD de Moodle 3.5
[[figure_er_diagram_moodle_db]]
image::er_diagram.png[]

Apenas puede extraerse información alguna de dicho diagrama que puede verse en la <<figure_er_diagram_moodle_db>>.
El elevado número de tablas que se analizan (que, como se ha visto, son 401) produce un diagrama con elementos superpuestos y dispuestos de forma abigarrada.
El objetivo de mostrarlo aquí, no obstante, es ilustrar el único punto significativo que puede destacarse del mismo, esto es, que no se observan dependencias relacionales entre las entidades de dicho diagrama.

Puesto que, a todas luces, es imposible que todas las tablas se correspondan con entidades aisladas sin relación con las demás entidades, se ha de suponer que esas relaciones no se establecen en la BD sino directamente en el código (posiblemente por medio de algún _framework_ específico para ello).
Todo ello supone una dificultad más en el análisis de los datos.

=== Esquema de una versión anterior

Como parte de la documentación de Moodle se encuentran ciertos diagramas E-R de su BD (en https://docs.moodle.org/dev/Database_Schema).

La última versión de la que existe esta documentación es la 3.3 (publicada en mayo de 2017).
Como ya se ha mencionado, esto no debería ser un problema puesto que es de suponer cierta estabilidad en el modelo de datos.

.Diagrama E-R de la BD de Moodle 3.3
[[figure_er_diagram_moodle_db_33]]
image::moodle_33_erd.png[]

Este diagrama, como se ve en <<figure_er_diagram_moodle_db_33>>, confirma las dos suposiciones del apartado anterior:

. sí existen relaciones entre las distintas entidades. En el diagrama, a simple vista, se aprecian numerosas interconexiones entre las tablas.
. el propio diagrama ofrece una agrupación por conceptos de las entidades. Si en el apartado anterior se mencionaban hasta 86 grupos, en el nuevo diagrama se aprecian 38 grupos distintos.

En la misma documentación donde se encuentra este diagrama, finalmente, se hace una especial hincapié de una selección de entre los 38 grupos. Se distinguen los siguientes 18 grupos:

* assignment
* advanced_grading
* badge
* course
* competency
* forum
* grading
* lesson
* messages
* question_bank
* question_types
* roles
* quiz
* scorm
* survey
* users_and_profiles
* wiki
* workshop


----

WARNING: Extraer el esquema de la BD Mysql de Moodle.
Posteriormente comparar con los datos facilitados en el _dataset_.




Una de las principales dificultades que se encuentran para realizar este tipo de análisis es la de encontrar un banco de datos en crudo lo suficientemente amplio como para que el análisis pueda ser significativo.
Uno de los principales motivos es la privacidad de los usuarios/alumnos/sujetos de estudio que se quiere preservar.

En este caso se ha hecho uso de una base de datos publicada por Moodle Pty Ltd con la información personal anonimizada para que no se pueda discernir de quién se trata.

Este conjunto de datos se encuentra disponible en la siguiente URL:
https://research.moodle.net/158/.

Además de los propios datos se facilita una descripción de los mismos de la cual se extrae a continuación la información más fundamental.

Los datos se corresponden con un curso impartido en learn.moodle.net durante cuatro semanas de 2016.

Si bien en el curso estaban inscritos 6119 alumnos, sólo 2167 de ellos dieron su permiso expreso para utilizar la información generada por ellos para la investigación académica. Por tanto sólo se disponde de los datos de estos 2167.

Además se anonimizó la información (por medio de un plugin específico para moodle).

El dataset dispone de cuatro ficheros:

*

=== Base de datos
=== Análisis y extracción de datos
=== Aplicación de algoritmos de datamining
=== Resultados
